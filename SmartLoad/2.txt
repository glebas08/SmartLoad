	Предварительная обработка 
Проверка общего объёма и массы груза. Массу груза получаем из характеристик груза. Объём груза считаем, как произведение длины, ширины и высоты, эти данные находятся в характеристики груза. 
Если объем превышает погрузочный объем прицепа (V_груза>V_прицепа) или масса превышает максимально допустимую грузоподъёмность (M_груза>M_макс), то программа выводит сообщение об ошибке и невозможности дальнейшей загрузки. 
На данном шаге мы убеждаемся, что груз можно загрузить в выбранный транспорт без нарушения его ограничений.
	Размещение продуктов
Для размещения груза будем использовать следующий алгоритм, в котором учитывается масса груза. В этот алгоритм приходит информация о продукции для конкретной точки: габариты, масса, количество.
	Формируем блоки[4]. 
	Формирование блоков из однотипных ящиков: 
Группируем ящики одного типа, учитывая их массу. Размещайте более тяжелые ящики ближе к центру прицепа. Все ящики одного типа группируются вместе. Если количество ящиков позволяет, они объединяются в один большой блок. Например: Ящики размером 2×2×4 можно объединить в блок размером 6×2×4 (3 ящика в длину). Это уменьшает количество отдельных элементов, которые нужно укладывать, и делает процесс более эффективным.
	Формирование блоков из разнотипных ящиков: 
Комбинируем ящики с совместимыми гранями, учитывая их массу. Общая масса блока должна быть распределена равномерно. Проверяется совместимость граней разных ящиков, например, ящик A (размеры 2×2×4) + Ящик B (размеры 2×2×6) → Блок (размеры 2×2×10). Условие совместимости: Общая грань должна быть одинаковой по размеру.
	Алгоритм 3D- укладки (сведение к 2D).
В различных местах алгоритма для нахождения наилучшего решения необходимо перебрать все возможные варианты сортировки некоторой последовательности элементов. К таким местам относятся:
a.	Формирование наборов предметов одинаковой высоты.
b.	Сортировка предметов и областей укладки по функционалу качества.
Однако полный перебор приведет к неприемлемо долгому времени расчета. Поэтому для сортировки используются функционалы качества, которые представляют собой взвешенные суммы некоторых характеристик элементов. Значения коэффициентов выбираются на основе эвристических соображений.

	Шаг 1: Группировка предметов по высоте
Цель данного шага: упростить задачу трёхмерной укладки, сводя её к двухмерной, например, все ящики и блоки сортируются по высоте. Для каждого уровня высоты создается отдельный набор предметов, например: ящики высотой 3м → Набор 1; ящики высотой 2 м → Набор 2; ящики высотой 1,5 м → Набор 3.
	Шаг 2: Сортировка наборов по функционалу качества
Цель данного шага: определить оптимальный набор для текущей области укладки. Функционал качества — это взвешенная сумма характеристик элементов, которая помогает выбрать "лучший" набор для укладки. Формула функционала качества для 3D-предметов:
Q_3=α_1∙h+α_2∙∑_(i=1)^N▒〖u(i)〗+α_3∙∑_(i=1)^N▒s(i) +α_4∙∑_(i=1)^N▒p(i) +α_5 ∑_(i=1)^N▒〖m(i)〗 
Где:
h - высота ящиков в наборе.
N - множество типов ящиков и блоков, входящих в набор.
v(i) - объем ящика или блока типа i.
s(i) - суммарная площадь всех граней ящика или блока типа i.
p(i) - суммарная длина линейных размеров ящика или блока типа 
 〖α_1,α_2,α_3,α_4,α〗_5 - коэффициенты, выбираемые на основе эвристических соображений.
	Шаг 3: Цикл укладки
 Выбор области укладки:
На каждом шаге выбирается область в прицепе, где будут размещаться предметы. Область должна иметь плоское основание с ломаной границей[3].
Выбор набора блоков:
Из отсортированных наборов выбирается ближайший набор, чья высота меньше или равна высоте области укладки.
Применение алгоритма 2D-укладки:
Для выбранной области и набора запускается алгоритм решения двумерной задачи укладки. Этот алгоритм размещает предметы в выбранной области, учитывая их форму и размеры.[2]
Q_2=β_1∙s(i)+β_2∙c(i)+β_3∙p(i)+β_4∙∆l(i) 
Где:
s(i) - площадь 2D-предмета i.
c(j) - площадь внутренней ломаной области j.
p(i) - периметр 2D-предмета i.
Δl(i) - разница длин минимального и максимального ребра 2D-предмета i.
β_1,β_(2,) β_3,β_4 - коэффициенты, выбираемые на основе эвристических соображений.
Обновление наборов:
После размещения предметов обновляется состав наборов (исключаются уже размещенные предметы). Запускается пересортировка всех наборов по функционалу качества.
Завершение цикла:
Цикл завершается, когда в очередную область укладки невозможно поместить ни одного предмета.
	Алгоритм расчёта нагрузки: 
Для начала разберём как применять правила перевозки грузов автомобильным транспортом, в части нагрузки по осям. Есть постановление правительства о правилах перевозки грузов [5]. 
В приложении 2 определена допустимая масса автопоезда. Массу автопоезда можно вычислить несколькими способами: 1) масса автопоезда плюс масса груза; 2) сумма нагрузок на все оси. 
В приложении 3 определена допустимая нагрузка на оси. На предпирятии, чаще использается автопоезда с пятью осями (две оси тягача и группа строенных осей полуприцепа). Оси тягача считаются одиночными осями и нагрузка на передню ось не должна превышать 10,5т, нагрузка на заднюю ось (ведущую) зависи от вида колёс. Чаще используется двускатные колёсые, следовательно, нагрузка на заднюю ось тягача не должна превышать 11,5т. Так как полуприцеп имеет строенную группу односкатных осей, то нагрузка на группу не должна превышать 20т. В приложении 3 есть примечения, в которых говориться о допустимой нагрузки на отдельные оси группы осей: «Для групп сближенных сдвоенных и строенных осей допустимая нагрузка на ось определяется путем деления допустимой нагрузки на группу осей на соответствующее количество осей в группе, за исключением случаев, указанных в пункте 4 настоящих примечаний.»[5]. Следоввательно, если у нас имеется полуприцеп с группой строенных осей, нагрузка на которую не должна превышать 20т, то нагрузка на отдельную ось из группы будет равна   20⁄3=6,6т. Допускается неравномерное распределение: «Допускается неравномерное распределение нагрузки по осям для групп сближенных сдвоенных и строенных осей, если нагрузка на группу осей не превышает допустимую нагрузку на соответствующую группу осей и нагрузка на каждую ось в группе осей не превышает допустимую нагрузку на соответствующую одиночную ось с односкатными или двускатными колесами.»[5]. Для нашего случая нагрузка на первую ось полуприцепа может быть 8т, на вторую ось 7т, а на третью 5т. Суммарно, нагрузка на группу осей составит 20т и нагрузка на отдельные оси не привышает 10,5т. В таком случае прегруза не будет.
Перейдём к алгоритму расчёта нагрузки:
1. Основная идея
Алгоритм рассматривает автопоезд как комбинацию одиночных транспортных средств, т.е. любой автопоезд представляется в виде системы из балок с опорами (оси) и распределенными нагрузками (груз + собственная масса). Расчет производится последовательно, начиная с полуприцепа и заканчивая тягачом. Это позволяет точно определить нагрузку на каждую ось в зависимости от расположения груза. Если вычисленная нагрузка Мп1 или Мп2 приходится на другое ТС – она используется как нагрузка Мг для него и расчет повторяется, если на дорогу – расчет останавливается.
Транспортное средство имеет снаряженную массу(масса порожнего ТС) - Mc, которая распределяется на переднюю (Mc1) и заднюю опоры (Mc2). Эти величины являются константами, определяемыми конструкцией конкретного ТС (Рисунок1).
 
Рисунок 1 – Распределение собственной массы ТС
Каждое одиночное транспортное средство считается абсолютно жесткой балкой, находящейся на двух опорах. Расстояние между опорами обозначается как ТКБ (Теоретическая колесная база) (Рисунок 2).
Для грузовых автомобилей, тягачей и прицепов передняя опора находится в центре передней оси, а задняя - в центре задней оси (если оси сдвоенные, строенные и т.д. -  берется геометрический центр тележки). Для полуприцепов передней опорой считается шкворень седельно-сцепного устройства.
 
Рисунок 2 - Теоретическая колесная база
На транспортное средство также воздействует нагрузка (Мг) вызванная  находящимся на нём грузом или полуприцепом через ССУ (Рисунок 3).
У нагрузки Мг есть величина (тонны) и точка приложения нагрузки. Для седельного тягача точкой нагрузки считается шкворень сцепного устройства, для полуприцепа – центр тяжести груза. Положение точки нагрузки (Xг) считается от задней опоры ТС. Нагрузка Мг также распределяется на переднюю (Mг1) и заднюю опоры (Mг2).
 
Рисунок 3 – Распределение нагрузки Мг по точкам опры
Для любого одиночного транспортного средства суммарная нагрузка (Рисунок 4) на переднюю опору (Мп1) рассчитывается как:
М_п1=М_с1+М_г1= М_с1+М_г×X_г/ТКБ 
а суммарная нагрузка на заднюю опору (Мп2) как:
М_п2=М_с2+М_г2= М_с2+М_г×(1-X_г/ТКБ) 
Далее, для вычисления осевых нагрузок, суммарные нагрузки Мп1 и Мп2 делятся на количество осей в соответствующей тележке.
 
Рисунок 4 – Суиарная нагрузка на опоры


2. Шаги алгоритма
Шаг 1: Вычисление суммарных нагрузок опор полуприцепа
〖Mп1〗_(п/пр)=М_с1+М_г∙Х_г/ТКБ
〖Mп2〗_(п/пр)=М_с2+М_г∙(1-Х_г/ТКБ)
 М_г — масса груза.
 М_с1,М_с2   — распределение снаряженной массы полуприцепа (масса без груза).
 Х_г — расстояние от центра тяжести (ЦТ) груза до задней опоры полуприцепа.
ТКБ — теоретическая колесная база полуприцепа (расстояние между передней и задней опорой).
Эти формулы позволяют разделить вес груза между передней и задней опорами полуприцепа пропорционально их удалению от центра тяжести груза.
Шаг 2: Расчет осевых нагрузок задней тележки полуприцепа
N= 〖Mп2〗_(п/пр)/n
N - осевые нагрузки
n – количество осей полуприцепа (сдвоенные, строенные оси)
Задняя тележка полуприцепа обычно состоит из трех осей. Поэтому общая нагрузка на заднюю тележку делится равномерно между ними.
Шаг 3: Вычисление суммарных нагрузок опор тягача
〖Mп1〗_тяг=М_с1+〖Mп1〗_(п/пр)∙Х_г/ТКБ
〖Mп2〗_тяг=М_с2+〖Mп1〗_(п/пр)∙(1-Х_г/ТКБ)
 〖Mп1〗_(п/пр) — нагрузка на переднюю опору полуприцепа (также называемая "нагрузкой на седло").
 М_с1,М_с2 — распределение снаряженной массы тягача.
 Х_г — расстояние от шкворня (ССУ) до задней опоры тягача.
ТКБ — теоретическая колесная база тягача.
Эти формулы учитывают влияние нагрузки от полуприцепа (через седло) на распределение веса между передней и задней опорами тягача.
Шаг 4: Расчет осевой нагрузки на переднюю ось тягача
Осевая нагрузка = 〖Mп1〗_тяг
Передняя ось тягача принимает на себя всю нагрузку от передней опоры тягача.
Шаг 5: Расчет осевых нагрузок задней тележки тягача
Осевые нагрузки =  〖Mп2〗_тяг/n
n – количество задних осей тягача (одна ось, сдвоенная ось, строенная)
Задняя тележка тягача обычно состоит из двух осей. Поэтому общая нагрузка на заднюю тележку делится равномерно между ними
Если перегрузка есть:
	Показывается предупреждение в виде эпюры с указанием перегруженной оси.
	Повторяется шаг размещения груза до достижения корректного распределения (цикл: пока существует хотя бы одна перегруженная ось).
Если перегрузки нет:
	Строится эпюра без перегрузки.
	Сохраняются результаты размещения.
На данном шаге мы убеждаемся, что нагрузка на каждую ось не превышает допустимые значения, установленные законодательством.
	Проверка наличия других точек разгрузки
На данном шаге мы проверяем есть ли другие точки разгрузки. Это необходимо для корректного размещения груза для всех точек разгрузки.
Если есть другие точки разгрузки:
	Повторить алгоритм для следующей точки (учитывая уже размещенные товары).
Если точек больше нет:
	Перейти к визуализации.
	Визуализация.
